<!-- app/views/articles/show.html.erb -->
<div class="max-w-screen-lg flex flex-col justify-center mx-auto">

  <header>
  <div id="publisher-header" class="flex items-center justify-center mb-4 text-gray-500">
   By: <%= @article.user.username + " - " + @article.created_at.to_s %>
  
    <% if user_signed_in? && current_user.id==@article.user_id %>
      <%= link_to edit_article_path(@article), class: "text-blue-500 font-bold ml-5 py-2 px-4 mr-2 hover:text-blue-700" do %>
      <i class="fas fa-edit fa-xl"></i>
    <% end %>
    <%= link_to article_path(@article), method: :delete, data: { confirm: 'Are you sure?' }, class: "text-red-500 font-bold py-2 px-4 hover:text-red-700" do %>
      <i class="fas fa-trash-alt fa-xl"></i>
    <% end %>
    <% end %>
  </div>

  <div id="theory-header" class="w-3/4 mx-auto text-center">
  <h1 class="text-2xl font-bold mb-4"><%= @article.title %></h1>
  <div class="mb-4">
    <p class="text-center"><%= @article.summary %></p>
  </div>
</div>
</header>
<div class="grid grid-cols-3 gap-6 mt-10">
  <section class="mb-4 col-span-2">
    <p><%= simple_format(@article.body) %></p>
  </section>
  <div>
    <h3 class="text-2xl mb-2 p-2"><strong>Similar Theories</strong> </h3>
    <%= render @articles %>
  </div>
</div>
  <section class="mb-4">
    <div class="article-images grid grid-cols-3">
      <% @article.documents.each do |document| %>
        <%= image_tag url_for(document.file), style: "max-width: 300px; max-height: 300px; margin: 10px;" %>
          <% end %>
    </div>
  </section>

  <div class="mb-4 w-full">
    <p>
      <% @article.tags.each do |tag| %>
        <span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">#
          <%= tag.name %></span>
        <% end %>
    </p>
  </div>

  <section class="w-full">
  <p class="text-gray-600 font-bold ml-2"><%= @article.vote_total %> votes</p>
  <div class="flex">
    <% if user_signed_in? %>
    <%# https://stackoverflow.com/questions/10468094/adding-a-twitter-bootstrap-button-icon-to-button-to-in-rails
        response 2
        %>
    
        <%
          upvoted = @article.votes.exists?(user: current_user, value: 1)
          downvoted = @article.votes.exists?(user: current_user, value: -1)
      
        upvote_class = " text-black font-bold rounded mx-2"
        downvote_class = "text-black font-bold rounded mx-2"
      
        upvote_icon_class = "fa-solid fa-chevron-up fa-xl#{' text-blue-500' if upvoted}"
        downvote_icon_class = "fa-solid fa-chevron-down fa-xl#{' text-blue-500' if downvoted}"
      %>
      
      <%= button_to upvote_article_path(@article), method: :post, class: upvote_class do %>
        <i class="<%= upvote_icon_class %>" id="postup"></i>
        upvote
      <% end %>
      
      <%= button_to downvote_article_path(@article), method: :post, class: downvote_class do %>
        <i class="<%= downvote_icon_class %>" id="postdown"></i>
        downvote
      <% end %>
    <% end %>
  </div>
</section>
  <h2 class="text-xl font-semibold mt-8 mb-4">Comments:</h2>

  <%= render @article.comments %>

  <% if user_signed_in? %>
    <h3 class="text-lg font-semibold mb-2">Add a comment:</h3>
    <%= render 'comments/form' %>
  <% else %>
    <p>Please <%= link_to 'sign in' , new_user_session_path,
        class: "text-blue-500 hover:text-blue-700" %> to comment.</p>
  <% end %>

  <%= link_to 'Back to Articles' , articles_path,
            class: "mt-4 inline-block text-blue-500 hover:text-blue-700" %>

</div>